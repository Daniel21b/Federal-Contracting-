<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Federal Contracting Bar Chart Race</title>
  <link rel="stylesheet" href="../CSS/styles.css"/>
  <link rel="stylesheet" href="../CSS/map.css"/>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script>
    // Save D3 v4 reference for the map
    var d3v4 = d3;
  </script>
  <script src="https://d3js.org/topojson.v3.min.js"></script>
  <script src="https://unpkg.com/flubber@0.4.2/build/flubber.min.js"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script>
    // Save D3 v6 reference for the chart
    var d3v6 = d3;
    // Restore D3 v4 reference for the map
    d3 = d3v4;
  </script>
</head>
<body>
  <div class="main-content">
    <h1>Tracing Federal Dollars: A State-by-State Exploration of U.S. Government Contracting</h1>

    <section id="map-section">
      <div class="map-header">
        <h2>State View</h2>
        <h2 id="state-name">California</h2>
      </div>

      <div class="map-grids">
        <div class="grid-container">
          <div class="inner-grid-container">
            <div class="region-selector">
              <h3>Select State</h3>
              <ul>
                <li><button onclick="morphToStateById('CA')">CA</button></li>
                <li><button onclick="morphToStateById('MD')">MD</button></li>
                <li><button onclick="morphToStateById('VA')">VA</button></li>
              </ul>
            </div>
            <div class="data-display">
              <div id="ca-description" class="state-description">
                <p>California leads in federal contracting with a diverse portfolio spanning technology, defense, and research. The state's major contractors include tech giants and defense contractors, with significant investments in aerospace, renewable energy, and healthcare research.</p>
              </div>
              <div id="md-description" class="state-description" style="display: none;">
                <p>Maryland's federal contracting landscape is dominated by defense and healthcare sectors, with strong presence of research institutions and government contractors. The state hosts numerous federal agencies and research facilities, making it a hub for government contracting.</p>
              </div>
              <div id="va-description" class="state-description" style="display: none;">
                <p>Virginia's proximity to Washington D.C. makes it a key player in federal contracting, particularly in defense and technology sectors. The state hosts numerous defense contractors and technology companies serving federal agencies.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="grid-container purple-grid">
          <div id="map-vis">
            <svg width="580" height="350"></svg>
          </div>
        </div>
      </div>
    </section>

    <section id="barchart-section">
    <section id="race-chart-section">
      <div class="race-chart-header">
        <h2>Contract Value Evolution</h2>
        <h2 id="race-chart-year">2021-2024</h2>
      </div>

      <div class="race-chart-container">
        <div class="race-chart-controls">
          <div class="control-panel">
            <h3>Visualization Controls</h3>
            <div class="state-selector">
              <h4>Select State</h4>
              <div class="button-group">
                <button class="race-state-button active" data-state="california">California</button>
                <button class="race-state-button" data-state="maryland">Maryland</button>
                <button class="race-state-button" data-state="virginia">Virginia</button>
              </div>
            </div>
            <div class="race-controls">
              <button id="restart-race" class="control-button">Restart Animation</button>
              <button id="pause-race" class="control-button">Pause</button>
            </div>
          </div>
          <div class="race-stats">
            <div id="current-stats">
              <h4>Current Statistics</h4>
              <p id="total-contracts">Total Contracts: <span>Loading...</span></p>
              <p id="top-contractor">Top Contractor: <span>Loading...</span></p>
              <p id="current-year">Year: <span>Loading...</span></p>
            </div>
          </div>
        </div>
        
        <div class="race-visualization">
          <div id="race-chart"></div>
        </div>
      </div>
    </section>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>About</h3>
        <p>Â© 2024 Federal Contracting Analysis</p>
        <p>All rights reserved.</p>
      </div>
      <div class="footer-section">
        <h3>Resources</h3>
        <ul>
          <li>Documentation</li>
          <li>Data Sources</li>
          <li>Methodology</li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Contact</h3>
        <ul>
          <li>Support</li>
          <li>Feedback</li>
          <li>GitHub</li>
        </ul>
      </div>
    </div>
  </footer>

  <script>
    // Set d3 to v4 for map
    d3 = d3v4;
  </script>
  <script src="../JS/map.js"></script>
  <script>
    // Set d3 to v6 for chart
    d3 = d3v6;
  </script>
  <script src="../JS/example.js"></script>
</body>
</html>
